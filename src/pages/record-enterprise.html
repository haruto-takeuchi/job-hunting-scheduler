<body>
  <div id="record-enterprise" class="no-display">
    <header class="title">企業情報の登録</header>
    <div style="margin: 1% 1% 5% 1%; font-size: 120%">
      企業名
      <input
        type="text"
        id="input-enterprise"
        placeholder="企業名を入力してください"
      />
    </div>
    <div>
      <button
        onclick="createNewCalendar()"
        style="font-weight: bold; padding: 0.5% 1%; margin: 1%"
      >
        登録
      </button>
    </div>
    <div>
      <button
        onclick="toEnterpriseList()"
        style="font-weight: bold; padding: 0.5% 1%; margin: 1%"
      >
        企業一覧
      </button>
    </div>
  </div>
  <script>
    function createNewCalendar() {
      const enterpriseName = document.getElementById("input-enterprise").value;

      if (!enterpriseName) {
        alert("企業名が未入力です");
      } else {
        google.script.run
          .withSuccessHandler((flag) => {
            alert(
              flag
                ? "企業の登録が成功しました"
                : "既に同名の企業が登録されています"
            );
            clearEnterpriseForm();
          })
          .createEnterpriseCalendar(enterpriseName);
      }
    }

    /**
     * 企業登録画面の入力フォームの初期化
     */
    function clearEnterpriseForm() {
      document.getElementById("input-enterprise").value = "";
    }

    function toEnterpriseList() {
      onChangeScreen("enterprise-list");
      showEnterpriseList();
    }
  </script>
</body>
