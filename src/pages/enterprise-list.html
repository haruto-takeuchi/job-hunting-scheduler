<body>
  <div id="enterprise-list">
    <header class="title">企業一覧</header>
    <div style="margin: 1%">
      <button class="btn" onclick="onChangeScreen('record-enterprise')">
        企業追加
      </button>
      <button class="btn" onclick="onChangeScreen('plan-list')">
        すべての予定
      </button>
    </div>
    <div id="show-enterprises"></div>
  </div>

  <script>
    function showEnterpriseList() {
      const btnInfo = [
        {
          text: "スケジュール",
          style: "background-color: yellow",
          page: "plan-list",
        },
        {
          text: "編集",
          style: "background-color: green; color: white",
          page: "record-enterprise",
        },
        {
          text: "削除",
          style: "background-color: red; color: white",
          page: "",
        },
      ];

      const enterpriseList = document.getElementById("show-enterprises");
      enterpriseList.innerHTML = ""; // 初期化
      google.script.run
        .withSuccessHandler((calendarList) => {
          calendarList.map((calendar) => {
            const enterpriseElement = document.createElement("div");
            enterpriseElement.setAttribute("style", "margin: 2%");
            enterpriseElement.innerHTML = calendar.name;

            // スケジュール、編集、削除ボタンを作成
            btnInfo.map((btnInfo) => {
              const scheduleBtn = document.createElement("button");
              scheduleBtn.innerText = btnInfo.text;
              scheduleBtn.setAttribute("class", "btn");
              scheduleBtn.setAttribute("style", btnInfo.style);
              scheduleBtn.setAttribute(
                "onClick",
                `clickBtn("${btnInfo.page}", "${calendar.id}")`
              );
              enterpriseElement.appendChild(scheduleBtn);
            });

            enterpriseList.appendChild(enterpriseElement);
          });
        })
        .getCalendarNameAndIdList();
    }
    showEnterpriseList();

    function clickBtn(transisionPage, calendarId) {
      sessionStorage.setItem("calendarId", calendarId);
      showPlanList(); // スケジュールボタンにだけ実装したい
      onChangeScreen(transisionPage);
    }
  </script>
</body>
